       IDENTIFICATION DIVISION.
       PROGRAM-ID. LOANINTR.
       AUTHOR. BANKING-SYSTEMS.
       DATE-WRITTEN. 2024-01-15.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  LOAN-DATA.
           05  PRINCIPAL      PIC 9(9)V99   VALUE ZEROS.
           05  INTEREST-RATE  PIC 9(2)V99   VALUE ZEROS.
           05  LOAN-TERM      PIC 9(3)      VALUE ZEROS.
           05  MONTHLY-RATE   PIC 9(2)V99   VALUE ZEROS.
           05  MONTHLY-PAYMENT PIC 9(9)V99  VALUE ZEROS.
           05  TOTAL-INTEREST PIC 9(9)V99   VALUE ZEROS.
           05  TOTAL-PAYMENT  PIC 9(9)V99   VALUE ZEROS.

       01  DISPLAY-FIELDS.
           05  DISPLAY-PRINCIPAL PIC ZZZ,ZZZ,ZZ9.99.
           05  DISPLAY-PAYMENT   PIC ZZZ,ZZZ,ZZ9.99.
           05  DISPLAY-INTEREST  PIC ZZZ,ZZZ,ZZ9.99.

       PROCEDURE DIVISION.
       MAIN-LOGIC.
           MOVE 100000.00 TO PRINCIPAL.
           MOVE 5.25 TO INTEREST-RATE.
           MOVE 360 TO LOAN-TERM.
           
           PERFORM CALCULATE-MONTHLY-RATE.
           PERFORM CALCULATE-PAYMENT.
           PERFORM CALCULATE-TOTALS.
           PERFORM DISPLAY-RESULTS.
           
           STOP RUN.

       CALCULATE-MONTHLY-RATE.
           COMPUTE MONTHLY-RATE = 
               INTEREST-RATE / 100 / 12.

       CALCULATE-PAYMENT.
           COMPUTE MONTHLY-PAYMENT = 
               PRINCIPAL * MONTHLY-RATE * 
               (1 + MONTHLY-RATE) ** LOAN-TERM /
               ((1 + MONTHLY-RATE) ** LOAN-TERM - 1).

       CALCULATE-TOTALS.
           COMPUTE TOTAL-PAYMENT = 
               MONTHLY-PAYMENT * LOAN-TERM.
           COMPUTE TOTAL-INTEREST = 
               TOTAL-PAYMENT - PRINCIPAL.

       DISPLAY-RESULTS.
           MOVE PRINCIPAL TO DISPLAY-PRINCIPAL.
           MOVE MONTHLY-PAYMENT TO DISPLAY-PAYMENT.
           MOVE TOTAL-INTEREST TO DISPLAY-INTEREST.
           
           DISPLAY "LOAN AMORTIZATION CALCULATION".
           DISPLAY "PRINCIPAL AMOUNT: $" DISPLAY-PRINCIPAL.
           DISPLAY "MONTHLY PAYMENT: $" DISPLAY-PAYMENT.
           DISPLAY "TOTAL INTEREST: $" DISPLAY-INTEREST.